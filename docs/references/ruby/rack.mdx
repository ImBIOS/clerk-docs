---
title: Rack Middleware
description: The Clerk Ruby SDK provides a Rack middleware to integrate Clerk into your Rack-based application.
---

The Clerk Ruby SDK provides a Rack middleware to integrate Clerk into your Rack-based application. To get started, add the following to your `config.ru` file:

```ruby {{ filename: 'config.ru' }}
require "rack"
require "clerk/rack"

require_relative "app"

use Clerk::Rack::Middleware
run App.new
```

Once you've added the middleware, you can access the `clerk` object in your actions and views.

The following example demonstrates how to create a simple Rack application that authenticates users and returns a greeting.

```ruby {{ filename: 'app.rb' }}
require "erb"
require "clerk"

class App
  def call(env)
    clerk = env["clerk"]

    return "Authenticated User: #{clerk.user.first_name}" if clerk.session
    return "Not Authenticated"
  end
end
```

## Re-verification actions

{/* TODO: Check out the reverification guide - how does that guide relate here, because that guide has some ruby code in it. */}

There are two ways to handle reverification in a Rack application:

1. Use the `Clerk::Rack::Reverification` middleware.
1. Handle reverification in your application logic.

### Using the `Clerk::Rack::Reverification` middleware

```ruby {{ filename: 'config.ru' }}
require "rack"
require "clerk/rack"

require_relative "app"

use Clerk::Rack
use Clerk::Rack::Reverification,
  preset: Clerk::StepUp::Preset::LAX, # defaults to `Clerk::StepUp::Preset::STRICT
  routes: ["/*"]

run App.new
```

### Handle Re-verification in your application logic.

```ruby {{ filename: 'app.rb' }}
require "erb"
require "clerk"

STEP_UP_PRESET = Clerk::StepUp::Preset::LAX

class App
  def call(env)
    clerk = env["clerk"]

    if clerk.user_needs_reverification?(STEP_UP_PRESET)
      return clerk.user_reverification_rack_response(STEP_UP_PRESET)
    end

    return "Authenticated User: #{clerk.user.first_name}" if clerk.session
    return "Not Authenticated"
  end
end
```

If you want to protect an action, you can add the `auth` filter to the action you're looking to protect.

If you would like to require the user to reverify their session, if necessary, you can add the `reverify` filter to the action you're looking to protect. The `reverify` filter can accept a boolean (defaults to `Clerk::StepUp::Preset::STRICT`) or a preset, such as `Clerk::StepUp::Preset::LAX`
