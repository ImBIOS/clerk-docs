---
title: Sinatra integration
description: The Clerk SDK comes with a Sinatra extension.
---

To use Clerk in Sinatra, you must `register` the `Sinatra::Clerk` extension.

```ruby
require "clerk/sinatra"
require "sinatra/base"

class App < Sinatra::Base
  register Sinatra::Clerk

  get "/" do
    @user = clerk.user
    erb :index, format: :html5
  end

  run! if app_file == $0
end
```

This gives your actions and views access to the `clerk` method.

## Protected & Re-verification actions

If you want to protect an action, you can add the `auth` filter to the action you're looking to protect.

If you would like to require the user to reverify their session, if necessary, you can add the `reverify` filter to the action you're looking to protect. The `reverify` filter can accept a boolean (defaults to `Clerk::StepUp::Preset::STRICT`) or a preset, such as `Clerk::StepUp::Preset::LAX`

```ruby
require "clerk/sinatra"
require "sinatra/base"

class App < Sinatra::Base
  register Sinatra::Clerk

  get "/" do
    erb :index, format: :html5
  end

  get "/admin", auth: true do
    @user = clerk.user
    erb :admin, format: :html5
  end

  post "/admin", auth: true, reverify: true do
    {message: clerk.user? ? "Valid session" : "Not logged in"}.to_json
  end

  run! if app_file == $0
end
```

Don't forget to set the environment variable `CLERK_SIGN_IN_URL` or the method `clerk_sign_in_url` will fail.

### Overriding the default behavior of the `auth` filter

By default, the `auth` filter will redirect to the sign-in page if the user is not logged in. You can override the default behavior of the `auth` filter:

```ruby
require "clerk/sinatra"
require "sinatra/base"

class App < Sinatra::Base
  register Sinatra::Clerk

  set(:auth) do |active|
    condition do
      # Don't forget to set the environment variable `CLERK_SIGN_IN_URL` or the method `sign_in_url` will fail.
      redirect clerk.sign_in_url if active && !clerk.session
    end
  end

  get "/" do
    erb :index, format: :html5
  end

  get "/admin", auth: true do
    @user = clerk.user
    erb :admin, format: :html5
  end

  post "/admin", auth: true, reverify: true do
    {message: clerk.user? ? "Valid session" : "Not logged in"}.to_json
  end

  run! if app_file == $0
end
```
